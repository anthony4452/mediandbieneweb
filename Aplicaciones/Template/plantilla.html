{% load static %}
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SeoDash Admin</title>
  <link rel="shortcut icon" type="image/png" href="{% static 'plantilla/seodash/src/assets/images/logos/seodashlogo.png' %}" />
  <link rel="stylesheet" href="{% static 'plantilla/seodash/src/assets/css/styles.min.css' %}" />

  <!-- Plugins -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/css/bootstrap-select.min.css">
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/2.3.1/css/dataTables.bootstrap5.min.css">

  <!-- Estilos personalizados para modo oscuro -->
  <style>
    /* Tema oscuro base */
    body.theme-dark {
      background-color: #121212 !important;
      color: #e0e0e0 !important;
    }
    
    /* Sidebar en modo oscuro */
    body.theme-dark .left-sidebar {
      background-color: #1a1a1a !important;
      border-right: 1px solid #333 !important;
    }
    
    body.theme-dark .sidebar-nav a {
      color: #ddd !important;
    }
    
    body.theme-dark .sidebar-nav a:hover {
      background-color: #2a2a2a !important;
      color: #fff !important;
    }
    
    body.theme-dark .nav-small-cap {
      color: #888 !important;
    }
    
    /* Header en modo oscuro */
    body.theme-dark .app-header {
      background-color: #1a1a1a !important;
      border-bottom: 1px solid #333 !important;
    }
    
    body.theme-dark .navbar-nav .nav-link {
      color: #ddd !important;
    }
    
    /* Cards y contenedores */
    body.theme-dark .card,
    body.theme-dark .bg-light,
    body.theme-dark .modal-content {
      background-color: #1e1e1e !important;
      color: #f5f5f5 !important;
      border-color: #333 !important;
    }
    
    body.theme-dark .card-header {
      background-color: #252525 !important;
      border-bottom: 1px solid #333 !important;
    }
    
    /* Formularios */
    body.theme-dark .form-control,
    body.theme-dark .form-select {
      background-color: #252525 !important;
      color: #fff !important;
      border-color: #444 !important;
    }
    
    body.theme-dark .form-control:focus,
    body.theme-dark .form-select:focus {
      background-color: #2a2a2a !important;
      border-color: #555 !important;
      box-shadow: 0 0 0 0.2rem rgba(255, 255, 255, 0.1) !important;
    }
    
    body.theme-dark .form-label {
      color: #ddd !important;
    }
    
    /* Botones */
    body.theme-dark .btn-outline-primary {
      color: #6c9bd1 !important;
      border-color: #6c9bd1 !important;
    }
    
    body.theme-dark .btn-outline-primary:hover {
      background-color: #6c9bd1 !important;
      color: #fff !important;
    }
    
    body.theme-dark .btn-outline-danger {
      color: #dc3545 !important;
      border-color: #dc3545 !important;
    }
    
    body.theme-dark .btn-outline-danger:hover {
      background-color: #dc3545 !important;
      color: #fff !important;
    }
    
    /* Tablas */
    body.theme-dark .table {
      background-color: #1e1e1e !important;
      color: #f5f5f5 !important;
      border-color: #333 !important;
    }
    
    body.theme-dark .table th,
    body.theme-dark .table td {
      border-color: #333 !important;
    }
    
    body.theme-dark .table-primary {
      background-color: #2a2a2a !important;
      color: #fff !important;
    }
    
    body.theme-dark .table-hover tbody tr:hover {
      background-color: #2a2a2a !important;
    }
    
    /* DataTables */
    body.theme-dark table.dataTable {
      background-color: #1e1e1e !important;
      color: #fff !important;
    }
    
    body.theme-dark .dataTables_wrapper .dataTables_length,
    body.theme-dark .dataTables_wrapper .dataTables_filter,
    body.theme-dark .dataTables_wrapper .dataTables_info,
    body.theme-dark .dataTables_wrapper .dataTables_paginate {
      color: #ddd !important;
    }
    
    body.theme-dark .dataTables_wrapper .dataTables_paginate .paginate_button {
      background-color: #2a2a2a !important;
      color: #ddd !important;
      border: 1px solid #444 !important;
    }
    
    body.theme-dark .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
      background-color: #333 !important;
      color: #fff !important;
    }
    
    body.theme-dark .dataTables_wrapper .dataTables_paginate .paginate_button.current {
      background-color: #007bff !important;
      color: #fff !important;
    }
    
    /* Dropdowns */
    body.theme-dark .dropdown-menu,
    body.theme-dark .bootstrap-select .dropdown-menu {
      background-color: #2a2a2a !important;
      color: #fff !important;
      border-color: #444 !important;
    }
    
    body.theme-dark .dropdown-item {
      color: #ddd !important;
    }
    
    body.theme-dark .dropdown-item:hover {
      background-color: #333 !important;
      color: #fff !important;
    }
    
    /* SweetAlert2 */
    body.theme-dark .swal2-popup {
      background-color: #1e1e1e !important;
      color: #fff !important;
    }
    
    body.theme-dark .swal2-title,
    body.theme-dark .swal2-content {
      color: #fff !important;
    }
    
    /* jQuery UI */
    body.theme-dark .ui-widget-content {
      background-color: #2a2a2a !important;
      color: #fff !important;
      border-color: #444 !important;
    }
    
    body.theme-dark .ui-widget-header {
      background-color: #333 !important;
      color: #fff !important;
      border-color: #555 !important;
    }
    
    /* Bootstrap Select */
    body.theme-dark .bootstrap-select .btn {
      background-color: #252525 !important;
      color: #fff !important;
      border-color: #444 !important;
    }
    
    body.theme-dark .bootstrap-select .btn:focus {
      box-shadow: 0 0 0 0.2rem rgba(255, 255, 255, 0.1) !important;
    }
    
    /* Alertas */
    body.theme-dark .alert {
      background-color: #2a2a2a !important;
      color: #fff !important;
      border-color: #444 !important;
    }
    
    body.theme-dark .alert-success {
      background-color: #1e3a2e !important;
      color: #4caf50 !important;
      border-color: #2e5233 !important;
    }
    
    body.theme-dark .alert-danger {
      background-color: #3a1e1e !important;
      color: #f44336 !important;
      border-color: #522e2e !important;
    }
    
    body.theme-dark .alert-warning {
      background-color: #3a3a1e !important;
      color: #ff9800 !important;
      border-color: #52521e !important;
    }
    
    body.theme-dark .alert-info {
      background-color: #1e2a3a !important;
      color: #2196f3 !important;
      border-color: #2e3352 !important;
    }
    
    /* Texto general */
    body.theme-dark .text-muted {
      color: #888 !important;
    }
    
    body.theme-dark .text-secondary {
      color: #aaa !important;
    }
    
    body.theme-dark .text-primary {
      color: #6c9bd1 !important;
    }
    
    /* Bordes y separadores */
    body.theme-dark hr {
      border-color: #333 !important;
    }
    
    body.theme-dark .border {
      border-color: #333 !important;
    }
    body.theme-dark .body-wrapper {
      background-color: #181a1b !important;
    }
    body.theme-dark main.container-fluid {
      background-color: #181a1b !important;
    }
  </style>
</head>

<body id="mainBody" class="theme-light">
<div class="page-wrapper" id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full">
  <aside class="left-sidebar">
    <div>
      <div class="brand-logo d-flex align-items-center justify-content-between">
        <a href="#" class="text-nowrap logo-img">
          <img src="{% static 'plantilla/seodash/src/assets/images/logos/logo-light.svg' %}" alt="" />
        </a>
        <div class="close-btn d-xl-none d-block sidebartoggler cursor-pointer" id="sidebarCollapse">
          <i class="ti ti-x fs-8"></i>
        </div>
      </div>

      <!-- Sidebar -->
      <nav class="sidebar-nav scroll-sidebar" data-simplebar="">
        <ul id="sidebarnav">
          {% if not user.is_authenticated %}
            <li class="sidebar-item">
              <a class="sidebar-link" href="{% url 'login' %}">
                <iconify-icon icon="solar:login-3-bold-duotone" class="fs-6"></iconify-icon>
                <span class="hide-menu">Login</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="{% url 'register' %}">
                <iconify-icon icon="solar:user-plus-rounded-bold-duotone" class="fs-6"></iconify-icon>
                <span class="hide-menu">Register</span>
              </a>
            </li>
          {% else %}
            <li class="sidebar-item">
              <a class="sidebar-link" href="{% url 'dashboard' %}">
                <iconify-icon icon="solar:home-smile-bold-duotone" class="fs-6"></iconify-icon>
                <span class="hide-menu">Dashboard</span>
              </a>
            </li>
            
            {% if user.rol == 'ADMINISTRADOR' %}
              <!-- Menú para Administrador -->
              <li class="nav-small-cap">
                <iconify-icon icon="solar:menu-dots-linear" class="nav-small-cap-icon fs-4"></iconify-icon>
                <span class="hide-menu">ADMINISTRACIÓN</span>
              </li>
              <li class="sidebar-item">
                <a class="sidebar-link" href="{% url 'propositos' %}">
                  <iconify-icon icon="solar:target-bold-duotone" class="fs-6"></iconify-icon>
                  <span class="hide-menu">Gestionar Propósitos</span>
                </a>
              </li>
              <li class="sidebar-item">
                <a class="sidebar-link" href="{% url 'sesiones_list' %}">
                  <iconify-icon icon="solar:meditation-bold-duotone" class="fs-6"></iconify-icon>
                  <span class="hide-menu">Gestionar Sesiones</span>
                </a>
              </li>
              <li class="sidebar-item">
                <a class="sidebar-link" href="{% url 'calendario_sesiones' %}">
                  <iconify-icon icon="solar:calendar-bold-duotone" class="fs-6"></iconify-icon>
                  <span class="hide-menu">Calendario</span>
                </a>
              </li>
            {% else %}
              <!-- Menú para Usuario -->
              <li class="nav-small-cap">
                <iconify-icon icon="solar:menu-dots-linear" class="nav-small-cap-icon fs-4"></iconify-icon>
                <span class="hide-menu">MI MEDITACIÓN</span>
              </li>
              <li class="sidebar-item">
                <a class="sidebar-link" href="{% url 'propositos' %}">
                  <iconify-icon icon="solar:target-bold-duotone" class="fs-6"></iconify-icon>
                  <span class="hide-menu">Mis Propósitos</span>
                </a>
              </li>
              <li class="sidebar-item">
                <a class="sidebar-link" href="{% url 'sesiones_list' %}">
                  <iconify-icon icon="solar:meditation-bold-duotone" class="fs-6"></iconify-icon>
                  <span class="hide-menu">Mis Sesiones</span>
                </a>
              </li>
              <li class="sidebar-item">
                <a class="sidebar-link" href="{% url 'calendario_sesiones' %}">
                  <iconify-icon icon="solar:calendar-bold-duotone" class="fs-6"></iconify-icon>
                  <span class="hide-menu">Mi Calendario</span>
                </a>
              </li>
            {% endif %}
            
            <li class="nav-small-cap">
              <iconify-icon icon="solar:menu-dots-linear" class="nav-small-cap-icon fs-4"></iconify-icon>
              <span class="hide-menu">CUENTA</span>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="#" onclick="alert('Funcionalidad en desarrollo')">
                <iconify-icon icon="solar:user-bold-duotone" class="fs-6"></iconify-icon>
                <span class="hide-menu">Mi Perfil</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="{% url 'logout' %}">
                <iconify-icon icon="solar:logout-bold-duotone" class="fs-6"></iconify-icon>
                <span class="hide-menu">Cerrar Sesión</span>
              </a>
            </li>
          {% endif %}
        </ul>
      </nav>
    </div>
  </aside>

  <div class="body-wrapper">
    <header class="app-header">
      <nav class="navbar navbar-expand-lg navbar-light">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item d-flex align-items-center me-3">
            <label class="form-check form-switch m-0">
              <input class="form-check-input" type="checkbox" id="modoOscuroToggle">
              <span class="ms-2">Modo Oscuro</span>
            </label>
          </li>
        </ul>
      </nav>
    </header>

    <!-- Contenido -->
    <main class="container-fluid mt-4">
      {% block content %}{% endblock %}
    </main>
  </div>
</div>

<!-- JS -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="{% static 'plantilla/seodash/src/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js' %}"></script>
<script src="{% static 'plantilla/seodash/src/assets/js/app.min.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/iconify-icon@1.0.8/dist/iconify-icon.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/js/bootstrap-select.min.js"></script>
<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js"></script>
<script src="https://cdn.datatables.net/2.3.1/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/2.3.1/js/dataTables.bootstrap5.min.js"></script>

    {% if messages%}
         {%for mensaje in messages%}
            <script>
              Swal.fire({
                title: "CONFIRMACIÓN",
                text: "{{mensaje}}",
                icon: "success"
              });
              </script>
         {%endfor%}
    {%endif%}

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toggle = document.getElementById("modoOscuroToggle");
    const body = document.getElementById("mainBody");
    const modo = localStorage.getItem("modo");
    if (modo === "oscuro") {
      body.classList.remove("theme-light");
      body.classList.add("theme-dark");
      toggle.checked = true;
    }
    toggle.addEventListener("change", function () {
      if (toggle.checked) {
        body.classList.replace("theme-light", "theme-dark");
        localStorage.setItem("modo", "oscuro");
      } else {
        body.classList.replace("theme-dark", "theme-light");
        localStorage.setItem("modo", "claro");
      }
    });
  });

</script>

{% block extra_js %}{% endblock %}
</body>
</html>
